<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Admin Login</title>

<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: 'Segoe UI', sans-serif;
  background: radial-gradient(circle at center, #000010 0%, #000020 100%);
  color: #00f5ff;
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
}
.circuit-bg {
  position: absolute; inset: 0;
  background: url('https://cdn.pixabay.com/photo/2016/12/06/18/27/abstract-1889593_1280.png') center/cover;
  opacity: 0.05; z-index: 0;
}
.login-container {
  z-index: 1;
  background: rgba(0,0,30,0.7);
  border: 2px solid #00f5ff;
  box-shadow: 0 0 40px #00f5ff;
  border-radius: 20px;
  padding: 40px 30px;
  width: 90%; max-width: 500px;
  text-align: center;
}
.login-container h2 {
  margin-bottom: 25px;
  font-size: 2rem;
  text-shadow: 0 0 10px #00f5ff;
}
.input-field { margin: 18px 0; }
.input-field input {
  width: 100%; padding: 12px 16px;
  border: 2px solid #00f5ff;
  background: transparent; color: #00f5ff;
  font-size: 1rem; border-radius: 8px; outline: none;
  transition: 0.3s;
}
.input-field input::placeholder { color: rgba(0,245,255,0.3); }
.input-field input:focus { box-shadow: 0 0 12px #00f5ff; }

.login-btn {
  width: 100%; padding: 12px;
  background: transparent; color: #00f5ff;
  border: 2px solid #00f5ff;
  border-radius: 8px; font-size: 1rem; font-weight: bold;
  cursor: pointer; margin-top: 20px;
  transition: all 0.3s ease;
}
.login-btn:hover {
  background: #00f5ff; color: #000; transform: scale(1.05);
}

.checkbox, .extra-options {
  margin-top: 15px; font-size: 0.9rem;
}
.extra-options a {
  color: #00f5ff; text-decoration: underline; cursor: pointer;
}
.error { color: #ff4b5c; font-size: 0.9rem; margin-top: 15px; }

@media screen and (max-width: 480px) {
  .login-container { padding: 30px 20px; }
}
</style>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

</head>
<body>
<div class="circuit-bg"></div>

<div class="login-container">
  <h2>Admin Login</h2>

  <form id="loginForm">
    <div class="input-field">
      <input type="email" id="email" placeholder="Email" required />
    </div>

    <div class="input-field">
      <input type="password" id="password" placeholder="Password" required />
    </div>

    <button type="submit" class="login-btn">Login</button>

    <div class="checkbox">
      <input type="checkbox" id="rememberMe" />
      <label for="rememberMe">Remember Me</label>
    </div>

    <div class="extra-options">
      <a onclick="forgotPassword()">Forgot Password?</a>
    </div>

    <div class="error" id="errorMsg"></div>
  </form>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyA7OMlPMAD-EbBokcTU3oEaExYUH-RgYrQ",
  authDomain: "smartqr-attendance-v2.firebaseapp.com",
  projectId: "smartqr-attendance-v2",
  storageBucket: "smartqr-attendance-v2.appspot.com",
  messagingSenderId: "780087067345",
  appId: "1:780087067345:web:01eba7dc700f9adf05fbf0"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// Forgot password function
function forgotPassword() {
  const email = document.getElementById('email').value.trim();
  const errorMsg = document.getElementById('errorMsg');

  if(!email){
    errorMsg.textContent = "❌ Enter your email to reset password.";
    return;
  }

  auth.sendPasswordResetEmail(email)
    .then(() => {
      errorMsg.style.color = "#00ff90";
      errorMsg.textContent = "✅ Password reset email sent! Check your inbox.";
    })
    .catch(err => {
      errorMsg.style.color = "#ff4b5c";
      if(err.code === "auth/user-not-found"){
        errorMsg.textContent = "❌ No account found with this email.";
      } else if(err.code === "auth/invalid-email"){
        errorMsg.textContent = "❌ Invalid email address.";
      } else {
        errorMsg.textContent = "❌ " + err.message;
      }
    });
}

// Login function
document.getElementById('loginForm').addEventListener('submit', (e) => {
  e.preventDefault();

  const email    = document.getElementById('email').value.trim().toLowerCase();
  const password = document.getElementById('password').value;
  const errorMsg = document.getElementById('errorMsg');

  auth.signInWithEmailAndPassword(email, password)
    .then(() => {
      // Remember me functionality
      const rememberMe = document.getElementById('rememberMe').checked;
      if(rememberMe){
        localStorage.setItem('adminEmail', email);
      } else {
        localStorage.removeItem('adminEmail');
      }
      window.location.href = "admin_sub.html";
    })
    .catch(err => {
      errorMsg.style.color = "#ff4b5c";
      if(err.code === "auth/user-not-found"){
        errorMsg.textContent = "❌ No account found with this email.";
      } else if(err.code === "auth/wrong-password"){
        errorMsg.textContent = "❌ Incorrect password.";
      } else {
        errorMsg.textContent = "❌ " + err.message;
      }
    });
});

// Auto-fill email if remembered
window.addEventListener('load', () => {
  const savedEmail = localStorage.getItem('adminEmail');
  if(savedEmail){
    document.getElementById('email').value = savedEmail;
    document.getElementById('rememberMe').checked = true;
  }
});
</script>

</body>
</html>
